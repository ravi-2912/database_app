{% extends "add.html" %}

{% block formcontent %}

<form action="/add/pipeline" method="POST">
    
    {% for pipeline in pipelines %}
    <div class="form-group">
        <label>
            {{ pipeline.short_name }} 
            {% if pipeline.name %}
                - {{ pipeline.name }}
            {% endif %}
        </label>
        <div>
            <a role="button" class="btn btn-info" href="{{ url_for('add_pipeline_info', line_name=pipeline.short_name) }}">
                Add Info
            </a>
        </div>
    </div>    
    {% endfor %}

    <div class="form-group d-flex mt-5">
        <a role="button" class="btn btn-secondary mr-2" href="/add/project">Back</a>
        <a role="button" class="btn btn-primary" href="{{ url_for('add_pipeline_info', line_name=pipelines[0].short_name) }}">Next</a>
    </div>
</form>

{% endblock %}

{% block scripts %}

<script type="text/javascript">
    $('#expand-od-form').change(function (e) {
        e.preventDefault();
        $(this).parent().toggleClass('text-success text-danger');
        $('.animate-plus').toggleClass('rotate-plus');
        $('#od-form').toggleClass('d-none')
        if (this.checked) {

        } else {

        }
    });

    $('#add-dia-text').click(function (e) {
        e.preventDefault();
        let prev_elem = $('#od-texts').children('div:nth-last-child(2)').children();
        let prev_elem_id = prev_elem.attr('id');
        let next_elem_id = prev_elem_id.split('-')[0] + '-' + (parseInt(prev_elem_id.split('-')[1]) + 1)
            .toString();
        html = `<div class="form-group col-md-2">
                    <input class="form-control" id="${next_elem_id}" name="${next_elem_id}" type="text" value="">
                </div>`;
        prev_elem.parent().after(html);
    });
    $('#rem-dia-text').click(function (e) {
        e.preventDefault();
        let last_elem = $('#od-texts').children('div:nth-last-child(2)');
        let elem_count = $('#od-texts').children().length - 1;
        console.log(elem_count)
        if (elem_count > 1) {
            last_elem.remove();
        }
    });
</script>
{% endblock %}